<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Earthquake Tracker</title>
  <link rel="stylesheet" href="style.css">
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>

  <!-- Header -->
  <header class="topbar">
    <h1>Earthquake Tracker</h1>
    <nav>
      <a href="https://github.com/Carol-A-Mosenki" target="_blank">GitHub</a>
      <a href="https://www.linkedin.com/in/abang-carol-mosenki-a8227a393/" target="_blank">LinkedIn</a>
    </nav>
  </header>

  <!-- Filter Panel -->
  <section class="filter-panel">
    <label for="magnitude">Minimum Magnitude:</label>
    <select id="magnitude">
      <option value="0">0+</option>
      <option value="2">2+</option>
      <option value="4">4+</option>
      <option value="6">6+</option>
    </select>
    <button id="refresh">Refresh Data</button>
    <span id="last-updated"></span>
  </section>

  <!-- Map -->
  <div id="map"></div>

  <!-- Cards / Latest Earthquakes -->
  <section id="results" class="results"></section>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="script.js"></script>
</body>
</html>




/* Reset & Body */
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Poppins', sans-serif; background:#111; color:#fff; }

/* Topbar */
.topbar {
  display:flex; justify-content:space-between; align-items:center;
  padding:1rem 2rem; background:#1a1a1a;
}
.topbar a { color:#A8DADC; margin-left:1rem; text-decoration:none; transition:0.3s; }
.topbar a:hover { color:#F1A6C7; }

/* Filter Panel */
.filter-panel {
  display:flex; align-items:center; gap:1rem;
  padding:1rem 2rem; background:#222; flex-wrap:wrap;
}
.filter-panel select, .filter-panel button {
  padding:0.5rem 1rem; border-radius:0.5rem; border:none;
  cursor:pointer; background:#A8DADC; color:#111; transition:0.3s;
}
.filter-panel select:hover, .filter-panel button:hover { background:#F1A6C7; }
#last-updated { margin-left:auto; font-size:0.9rem; color:#ccc; }

/* Map */
#map { height:60vh; width:100%; margin-bottom:1rem; }

/* Result Cards */
.results {
  display:flex; flex-wrap:wrap; justify-content:center; gap:1rem; padding:1rem;
}
.result-card {
  background:#222; border-radius:1rem; padding:1rem; width:250px;
  color:#fff; transition:transform 0.3s, box-shadow 0.3s;
}
.result-card:hover {
  transform:translateY(-5px); box-shadow:0 0 20px rgba(255,255,255,0.2);
}




// Initialize Leaflet Map

const map = L.map('map').setView([20,0], 2);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
  attribution:'&copy; OpenStreetMap contributors'
}).addTo(map);


// Elements

const resultsDiv = document.getElementById("results");
const magnitudeSelect = document.getElementById("magnitude");
const refreshBtn = document.getElementById("refresh");
const lastUpdated = document.getElementById("last-updated");


// Fetch Earthquake Data

async function fetchEarthquakes() {
  resultsDiv.innerHTML = "<p>Loading earthquake data...</p>";
  try {
    const res = await fetch('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson');
    const data = await res.json();
    renderEarthquakes(data.features);
    lastUpdated.textContent = "Last updated: " + new Date().toLocaleTimeString();
  } catch(err) {
    console.error(err);
    resultsDiv.innerHTML = "<p>Failed to load data.</p>";
  }
}


// Render Earthquakes

function renderEarthquakes(features) {
  resultsDiv.innerHTML = "";
  map.eachLayer(layer=>{
    if(layer.options && layer.options.pane==="markerPane") map.removeLayer(layer);
  });

  const minMag = parseFloat(magnitudeSelect.value);

  features
    .filter(eq => eq.properties.mag >= minMag)
    .sort((a,b)=>b.properties.mag - a.properties.mag)
    .forEach(eq => {
      const { mag, place, time, url } = eq.properties;
      const [lat, lng, depth] = eq.geometry.coordinates;

      // Marker
      const color = mag >= 6 ? "#F1A6C7" : mag >=4 ? "#FFF3B0" : "#A8DADC";
      const marker = L.circleMarker([lng,lat],{
        radius: mag*2,
        fillColor: color,
        color: "#fff",
        weight:1,
        fillOpacity:0.7
      }).addTo(map);
      marker.bindPopup(`<strong>${place}</strong><br>Magnitude: ${mag}<br>Depth: ${depth} km<br><a href="${url}" target="_blank">More info</a>`);

      // Card
      const card = document.createElement("div");
      card.className="result-card";
      card.innerHTML=`
        <h3>${place}</h3>
        <p><strong>Magnitude:</strong> ${mag}</p>
        <p><strong>Depth:</strong> ${depth} km</p>
        <p><strong>Time:</strong> ${new Date(time).toLocaleString()}</p>
        <a href="${url}" target="_blank">More info</a>
      `;
      resultsDiv.appendChild(card);
    });
}

// Event Listeners

magnitudeSelect.addEventListener("change", fetchEarthquakes);
refreshBtn.addEventListener("click", fetchEarthquakes);

// Initial Load
fetchEarthquakes();
